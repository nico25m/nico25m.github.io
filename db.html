<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Registrati</title>
</head>
<body>
  <h2>Registrati</h2>
  <form id="formReg">
    <input type="text" name="name" placeholder="Nome" required /><br />
    <input type="text" name="surname" placeholder="Cognome" required /><br />
    <input type="email" name="email" placeholder="Email" required /><br />
    <input type="password" name="password" placeholder="Password" required /><br />
    <input type="password" name="confirm_password" placeholder="Conferma Password" required /><br />
    <button type="submit">Registrati</button>
  </form>

  <p id="msg"></p>

<script>
const form = document.getElementById('formReg');
const msg = document.getElementById('msg');

form.addEventListener('submit', (e) => {
  e.preventDefault();

  const formData = new FormData(form);
  const data = {
    name: formData.get('name'),
    surname: formData.get('surname'),
    email: formData.get('email'),
    password: formData.get('password'),
    confirm_password: formData.get('confirm_password')
  };

  if(data.password !== data.confirm_password){
    msg.textContent = "Le password non corrispondono";
    msg.style.color = "red";
    return;
  }

  fetch('http://nico25m.page.gd/api_registrati.php', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  })
  .then(res => res.json())
  .then(res => {
    if(res.success){
      msg.textContent = res.success;
      msg.style.color = "green";
      form.reset();
    } else {
      msg.textContent = res.error || "Errore sconosciuto";
      msg.style.color = "red";
    }
  })
  .catch(() => {
    msg.textContent = "Errore di rete";
    msg.style.color = "red";
  });
});
</script>
</body>
</html>
